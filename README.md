# Merlin Chain Function Calling æ•°æ®é›†ç”Ÿæˆå·¥å…·

ğŸš€ åŸºäºDeepSeek APIå’ŒMCPå·¥å…·çš„æ™ºèƒ½æ•°æ®é›†ç”Ÿæˆç³»ç»Ÿï¼Œæ”¯æŒç”Ÿæˆé«˜è´¨é‡çš„function callingè®­ç»ƒæ•°æ®ã€‚

## ğŸ“‹ ç›®å½•

- [åŠŸèƒ½ç‰¹æ€§](#åŠŸèƒ½ç‰¹æ€§)
- [ç³»ç»Ÿæ¶æ„](#ç³»ç»Ÿæ¶æ„)
- [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
- [é…ç½®è¯´æ˜](#é…ç½®è¯´æ˜)
- [ä½¿ç”¨æŒ‡å—](#ä½¿ç”¨æŒ‡å—)
- [è¿›é˜¶åŠŸèƒ½](#è¿›é˜¶åŠŸèƒ½)
- [æ•…éšœæ’é™¤](#æ•…éšœæ’é™¤)
- [æ–‡ä»¶è¯´æ˜](#æ–‡ä»¶è¯´æ˜)

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### ğŸ§  æ™ºèƒ½é—®é¢˜ç”Ÿæˆ (`generate_question_dataset_smart.py`)
- **æ™ºèƒ½å»é‡**: åŸºäºé—®é¢˜æ¨¡å¼å»é‡ï¼Œé¿å…é‡å¤ç”Ÿæˆ
- **å·¥å…·å¹³è¡¡**: ç¡®ä¿19ä¸ªMCPå·¥å…·çš„é—®é¢˜åˆ†å¸ƒå‡è¡¡
- **è¿›åº¦è·Ÿè¸ª**: æŒä¹…åŒ–çŠ¶æ€ç®¡ç†ï¼Œæ”¯æŒæ–­ç‚¹ç»­ä¼ 
- **å®‰å…¨é€€å‡º**: ç±»ä¼¼Go deferçš„æœºåˆ¶ï¼ŒCtrl+Cæ—¶è‡ªåŠ¨ä¿å­˜æ•°æ®
- **é…ç½®åŒ–**: æ”¯æŒé…ç½®æ–‡ä»¶ã€å‘½ä»¤è¡Œã€ç¯å¢ƒå˜é‡å¤šç§é…ç½®æ–¹å¼

### ğŸ”§ å®Œæ•´æ•°æ®è¡¥å…¨ (`generate_complete_dataset.py`)
- **çœŸå®Function Calling**: é›†æˆMCPå®¢æˆ·ç«¯ï¼Œç”ŸæˆçœŸå®çš„å·¥å…·è°ƒç”¨å’Œå“åº”
- **æ™ºèƒ½å·¥å…·æ¨æ–­**: æ ¹æ®ç”¨æˆ·é—®é¢˜è‡ªåŠ¨é€‰æ‹©åˆé€‚çš„MCPå·¥å…·
- **æ‰¹é‡å¤„ç†**: æ”¯æŒæ‰¹é‡å¤„ç†ï¼Œé¿å…APIé™æµ
- **è¯¦ç»†æ—¥å¿—**: å®Œæ•´çš„æ—¥å¿—è®°å½•ï¼Œä¾¿äºè°ƒè¯•å’Œç›‘æ§

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æ•°æ®é›†ç”Ÿæˆæµç¨‹                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                           â”‚
â”‚  Step 1: é—®é¢˜ç”Ÿæˆé˜¶æ®µ                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  generate_question_dataset_smart.py                 â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚ é…ç½®ç®¡ç†å™¨    â”‚  â”‚ å»é‡ç®¡ç†å™¨    â”‚  â”‚ DeepSeek APIâ”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚         â”‚               â”‚               â”‚         â”‚   â”‚
â”‚  â”‚         â–¼               â–¼               â–¼         â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚    æ™ºèƒ½promptç”Ÿæˆ + å·¥å…·åˆ†é… + æ‰¹é‡ç”Ÿæˆ            â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                          â”‚                               â”‚
â”‚                          â–¼                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚          function_calling_dataset_smart.json        â”‚   â”‚
â”‚  â”‚               (é—®é¢˜ + ç”¨æˆ·å¯¹è¯)                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                          â”‚                               â”‚
â”‚                          â–¼                               â”‚
â”‚  Step 2: å®Œæ•´è¡¥å…¨é˜¶æ®µ                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  generate_complete_dataset.py                       â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚ MCPå®¢æˆ·ç«¯    â”‚  â”‚ å·¥å…·æ¨æ–­å™¨    â”‚  â”‚ DeepSeek APIâ”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â”‚         â”‚               â”‚               â”‚         â”‚   â”‚
â”‚  â”‚         â–¼               â–¼               â–¼         â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚   â”‚
â”‚  â”‚  â”‚ çœŸå®å·¥å…·è°ƒç”¨ + ç»“æœè·å– + GPTå›å¤ç”Ÿæˆ              â”‚ â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                          â”‚                               â”‚
â”‚                          â–¼                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚       function_calling_dataset_completed.json       â”‚   â”‚
â”‚  â”‚    (å®Œæ•´çš„function callingè®­ç»ƒæ•°æ®)                    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡

```bash
# å…‹éš†é¡¹ç›®
git clone <your-repo-url>
cd ai_dataset

# å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

### 2. é…ç½®è®¾ç½®

å¤åˆ¶é…ç½®æ¨¡æ¿å¹¶è®¾ç½®API Keyï¼š

```bash
# å¤åˆ¶é…ç½®æ¨¡æ¿
cp config.template.json config.json

# ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼Œè®¾ç½®ä½ çš„API Key
vim config.json
```

æˆ–è€…è®¾ç½®ç¯å¢ƒå˜é‡ï¼š

```bash
export DEEPSEEK_API_KEY="your-deepseek-api-key-here"
```

### 3. ç”Ÿæˆé—®é¢˜æ•°æ®é›†

```bash
# ä½¿ç”¨é»˜è®¤é…ç½®ç”Ÿæˆé—®é¢˜
python generate_question_dataset_smart.py

# æˆ–è€…è‡ªå®šä¹‰å‚æ•°
python generate_question_dataset_smart.py \
  --total_conversations 1000 \
  --batch_size 20
```

### 4. ç”Ÿæˆå®Œæ•´æ•°æ®é›†

```bash
# åŸºäºé—®é¢˜æ•°æ®é›†ç”Ÿæˆå®Œæ•´çš„function callingæ•°æ®
python generate_complete_dataset.py

# æˆ–è€…æŒ‡å®šè¾“å…¥æ–‡ä»¶
python generate_complete_dataset.py \
  --question_file function_calling_dataset_smart.json \
  --batch_size 5
```

## âš™ï¸ é…ç½®è¯´æ˜

### é…ç½®æ–‡ä»¶ç»“æ„ (`config.json`)

```json
{
  "api": {
    "deepseek_api_key": "your-api-key-here",
    "base_url": "https://api.deepseek.com",
    "timeout": 60
  },
  "generation": {
    "default_total_conversations": 6000,
    "default_batch_size": 50,
    "default_prompt_file": "prompt.txt",
    "default_output_file": "function_calling_dataset_smart.json",
    "system_prompt_file": "prompt-2.txt"
  },
  "completion": {
    "default_question_file": "function_calling_dataset_smart.json",
    "default_output_file": "function_calling_dataset_completed.json",
    "default_batch_size": 1,
    "enable_mcp_connection": true,
    "api_retry_count": 3,
    "batch_delay_seconds": 3
  },
  "system": {
    "enable_debug": false,
    "auto_cleanup_temp_files": true,
    "max_retries": 3
  }
}
```

### é…ç½®é¡¹è¯´æ˜

| é…ç½®é¡¹ | è¯´æ˜ | é»˜è®¤å€¼ |
|--------|------|--------|
| `api.deepseek_api_key` | DeepSeek APIå¯†é’¥ | å¿…å¡« |
| `generation.default_total_conversations` | ç›®æ ‡ç”Ÿæˆå¯¹è¯æ•°é‡ | 6000 |
| `generation.default_batch_size` | æ¯æ‰¹ç”Ÿæˆæ•°é‡ | 50 |
| `completion.default_batch_size` | å®Œæ•´åŒ–æ‰¹æ¬¡å¤§å° | 1 |
| `system.auto_cleanup_temp_files` | è‡ªåŠ¨æ¸…ç†ä¸´æ—¶æ–‡ä»¶ | true |

## ğŸ“– ä½¿ç”¨æŒ‡å—

### é—®é¢˜ç”Ÿæˆé˜¶æ®µ

#### åŸºç¡€ç”¨æ³•

```bash
# é»˜è®¤ç”Ÿæˆ6000ä¸ªå¯¹è¯ï¼Œæ¯æ‰¹50ä¸ª
python generate_question_dataset_smart.py

# å°è§„æ¨¡æµ‹è¯•
python generate_question_dataset_smart.py --total_conversations 100 --batch_size 10

# é‡ç½®çŠ¶æ€é‡æ–°å¼€å§‹
python generate_question_dataset_smart.py --reset
```

#### è¾“å‡ºæ–‡ä»¶

- **ä¸»æ–‡ä»¶**: `function_calling_dataset_smart.json` - æœ€ç»ˆçš„é—®é¢˜æ•°æ®é›†
- **ä¸´æ—¶æ–‡ä»¶**: `temp_smart_question_batch_*_*.json` - æ‰¹æ¬¡ä¸´æ—¶æ–‡ä»¶ï¼ˆä¼šè‡ªåŠ¨æ¸…ç†ï¼‰
- **çŠ¶æ€æ–‡ä»¶**: `generation_state.json` - è¿›åº¦å’Œå»é‡çŠ¶æ€

#### ç”Ÿæˆç‰¹æ€§

1. **æ™ºèƒ½å·¥å…·åˆ†é…**: è‡ªåŠ¨ä¸º19ä¸ªMCPå·¥å…·åˆ†é…é—®é¢˜æ•°é‡
2. **å»é‡æ£€æŸ¥**: åŸºäºé—®é¢˜æ¨¡å¼è‡ªåŠ¨å»é‡
3. **æ–­ç‚¹ç»­ä¼ **: æ”¯æŒä¸­æ–­åç»§ç»­ç”Ÿæˆ
4. **å®‰å…¨é€€å‡º**: Ctrl+Cæ—¶è‡ªåŠ¨ä¿å­˜å·²ç”Ÿæˆæ•°æ®

### å®Œæ•´æ•°æ®è¡¥å…¨é˜¶æ®µ

#### åŸºç¡€ç”¨æ³•

```bash
# ä½¿ç”¨é»˜è®¤è¾“å…¥æ–‡ä»¶
python generate_complete_dataset.py

# æŒ‡å®šè¾“å…¥æ–‡ä»¶å’Œæ‰¹æ¬¡å¤§å°
python generate_complete_dataset.py \
  --question_file my_questions.json \
  --batch_size 3
```

#### è¾“å‡ºæ–‡ä»¶

- **ä¸»æ–‡ä»¶**: `function_calling_dataset_completed.json` - å®Œæ•´çš„è®­ç»ƒæ•°æ®
- **ä¸´æ—¶æ–‡ä»¶**: `temp_complete_batch_*.json` - æ‰¹æ¬¡ä¸´æ—¶æ–‡ä»¶
- **æ—¥å¿—æ–‡ä»¶**: `complete_dataset.log` - è¯¦ç»†æ‰§è¡Œæ—¥å¿—

#### è¡¥å…¨ç‰¹æ€§

1. **çœŸå®å·¥å…·è°ƒç”¨**: è¿æ¥MCPæœåŠ¡å™¨æ‰§è¡ŒçœŸå®çš„å·¥å…·è°ƒç”¨
2. **æ™ºèƒ½å·¥å…·æ¨æ–­**: æ ¹æ®é—®é¢˜å†…å®¹è‡ªåŠ¨é€‰æ‹©åˆé€‚å·¥å…·
3. **å®Œæ•´å¯¹è¯ç”Ÿæˆ**: åŒ…å«function_callã€observationã€gptä¸‰ä¸ªé˜¶æ®µ

## ğŸ”§ è¿›é˜¶åŠŸèƒ½

### å¤šç§é…ç½®æ–¹å¼

```bash
# 1. é…ç½®æ–‡ä»¶æ–¹å¼ï¼ˆæ¨èï¼‰
python generate_question_dataset_smart.py

# 2. ç¯å¢ƒå˜é‡æ–¹å¼
export DEEPSEEK_API_KEY="your-key"
python generate_question_dataset_smart.py

# 3. å‘½ä»¤è¡Œæ–¹å¼
python generate_question_dataset_smart.py --api_key "your-key"

# 4. è‡ªå®šä¹‰é…ç½®æ–‡ä»¶
python generate_question_dataset_smart.py --config my_config.json
```

### æ‰¹é‡å¤„ç†ç­–ç•¥

```bash
# å¤§æ‰¹é‡å¿«é€Ÿç”Ÿæˆï¼ˆé—®é¢˜é˜¶æ®µï¼‰
python generate_question_dataset_smart.py \
  --total_conversations 5000 \
  --batch_size 100

# å°æ‰¹é‡ç²¾ç»†å¤„ç†ï¼ˆå®Œæ•´åŒ–é˜¶æ®µï¼‰
python generate_complete_dataset.py \
  --batch_size 1  # é¿å…APIé™æµ
```

### çŠ¶æ€ç®¡ç†

```bash
# æŸ¥çœ‹å½“å‰ç”ŸæˆçŠ¶æ€
cat generation_state.json

# é‡ç½®çŠ¶æ€é‡æ–°å¼€å§‹
python generate_question_dataset_smart.py --reset

# æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
tail -f complete_dataset.log
```

## ğŸ—‚ï¸ æ–‡ä»¶è¯´æ˜

### æ ¸å¿ƒè„šæœ¬

| æ–‡ä»¶ | è¯´æ˜ | ä½œç”¨ |
|------|------|------|
| `generate_question_dataset_smart.py` | æ™ºèƒ½é—®é¢˜ç”Ÿæˆå™¨ | ç”Ÿæˆç”¨æˆ·é—®é¢˜å’Œåˆå§‹å¯¹è¯ |
| `generate_complete_dataset.py` | å®Œæ•´æ•°æ®è¡¥å…¨å™¨ | è¡¥å…¨function callingå“åº” |
| `config_manager.py` | é…ç½®ç®¡ç†å™¨ | ç»Ÿä¸€é…ç½®æ–‡ä»¶ç®¡ç† |

### å·¥å…·æ¨¡å—

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `deepseek_api_client.py` | DeepSeek APIå®¢æˆ·ç«¯ |
| `dataset_utils.py` | æ•°æ®é›†å¤„ç†å·¥å…· |
| `dedup_manager.py` | å»é‡ç®¡ç†å™¨ |
| `merlin_mcp_client.py` | MCPå®¢æˆ·ç«¯ |

### é…ç½®æ–‡ä»¶

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `config.json` | ä¸»é…ç½®æ–‡ä»¶ï¼ˆåŒ…å«API Keyï¼‰ |
| `config.template.json` | é…ç½®æ¨¡æ¿ï¼ˆä¾›å‚è€ƒï¼‰ |
| `prompt.txt` | é—®é¢˜ç”Ÿæˆæç¤ºè¯ |
| `prompt-2.txt` | å®Œæ•´åŒ–æç¤ºè¯ |

### çŠ¶æ€æ–‡ä»¶

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `generation_state.json` | ç”ŸæˆçŠ¶æ€å’Œå»é‡æ•°æ® |
| `complete_dataset.log` | å®Œæ•´åŒ–è¿‡ç¨‹æ—¥å¿— |

## ğŸ› ï¸ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. API Key é…ç½®é—®é¢˜

```bash
# é”™è¯¯ï¼šâŒ é…ç½®é”™è¯¯: API Keyæœªé…ç½®
# è§£å†³ï¼šè®¾ç½®API Key
echo '{"api": {"deepseek_api_key": "your-key"}}' > config.json
```

#### 2. ä¸´æ—¶æ–‡ä»¶æ¸…ç†é—®é¢˜

```bash
# æ‰‹åŠ¨æ¸…ç†ä¸´æ—¶æ–‡ä»¶
rm temp_smart_question_batch_*.json
rm temp_complete_batch_*.json
```

#### 3. çŠ¶æ€é‡ç½®

```bash
# å®Œå…¨é‡ç½®çŠ¶æ€
rm generation_state.json
python generate_question_dataset_smart.py --reset
```

#### 4. MCPè¿æ¥é—®é¢˜

```bash
# æ£€æŸ¥MCPæœåŠ¡æ˜¯å¦è¿è¡Œ
# æŸ¥çœ‹æ—¥å¿—è·å–è¯¦ç»†é”™è¯¯ä¿¡æ¯
tail -f complete_dataset.log
```

### æ€§èƒ½ä¼˜åŒ–

#### 1. æ‰¹æ¬¡å¤§å°è°ƒä¼˜

```bash
# é—®é¢˜ç”Ÿæˆé˜¶æ®µï¼šå¤§æ‰¹æ¬¡æé«˜æ•ˆç‡
--batch_size 100

# å®Œæ•´åŒ–é˜¶æ®µï¼šå°æ‰¹æ¬¡é¿å…é™æµ
--batch_size 1
```

#### 2. å¹¶å‘æ§åˆ¶

```bash
# é¿å…APIé™æµï¼Œå¢åŠ å»¶è¿Ÿ
# åœ¨config.jsonä¸­è®¾ç½®ï¼š
"batch_delay_seconds": 5
```

## ğŸ“Š ç”Ÿæˆç»Ÿè®¡

### å·¥å…·åˆ†å¸ƒç›®æ ‡

ç³»ç»Ÿä¼šè‡ªåŠ¨ä¸º19ä¸ªMCPå·¥å…·åˆ†é…ç›®æ ‡æ•°é‡ï¼š

- `get_address_details_by_address`: 600ä¸ª
- `get_token_info_by_address`: 480ä¸ª
- `list_address_latest_txs`: 480ä¸ª
- `get_tx_by_hash`: 420ä¸ª
- `search_chain_data`: 420ä¸ª
- å…¶ä»–å·¥å…·: 180-300ä¸ªä¸ç­‰

### ç”¨æˆ·è§’è‰²åˆ†å¸ƒ

- åŒºå—é“¾å°ç™½: 30%
- åŒºå—é“¾å¼€å‘è€…: 30%
- åŒºå—é“¾æŠ•èµ„è€…: 25%
- åŒºå—é“¾ä¸“å®¶: 15%

### è¯­è¨€é£æ ¼åˆ†å¸ƒ

- å£è¯­åŒ–: 35%
- æŠ€æœ¯ç”¨è¯­: 25%
- ä¸­è‹±æ··åˆ: 25%
- é”™è¯¯è¡¨è¾¾: 15%

## ğŸ”’ å®‰å…¨æ³¨æ„äº‹é¡¹

1. **API Keyä¿æŠ¤**: `config.json` å·²æ·»åŠ åˆ° `.gitignore`ï¼Œä¸ä¼šæäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶
2. **ç¯å¢ƒå˜é‡**: æ¨èåœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ç¯å¢ƒå˜é‡è®¾ç½®API Key
3. **é…ç½®æ¨¡æ¿**: ä½¿ç”¨ `config.template.json` ä½œä¸ºé…ç½®å‚è€ƒ

## ğŸ“ æ›´æ–°æ—¥å¿—

### v2.0.0 (Current)
- âœ… é‡æ„ä¸ºé…ç½®æ–‡ä»¶ç®¡ç†
- âœ… æ™ºèƒ½å»é‡å’Œå·¥å…·å¹³è¡¡
- âœ… å®‰å…¨é€€å‡ºæœºåˆ¶
- âœ… çœŸå®MCPå·¥å…·è°ƒç”¨
- âœ… å®Œæ•´çš„æ—¥å¿—ç³»ç»Ÿ

### v1.0.0
- âœ… åŸºç¡€é—®é¢˜ç”ŸæˆåŠŸèƒ½
- âœ… ç®€å•çš„function callingè¡¥å…¨

## ğŸ“ æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. é…ç½®æ–‡ä»¶æ˜¯å¦æ­£ç¡®è®¾ç½®
2. API Keyæ˜¯å¦æœ‰æ•ˆ
3. ç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸
4. æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶è·å–è¯¦ç»†é”™è¯¯ä¿¡æ¯

---

ğŸ‰ ç°åœ¨ä½ å¯ä»¥å¼€å§‹ç”Ÿæˆé«˜è´¨é‡çš„Merlin Chain function callingæ•°æ®é›†äº†ï¼

- ğŸ”¥ ä½¿ç”¨ Deepseek API ä½œä¸ºæ•°æ®ç”Ÿæˆå¼•æ“
- ğŸ”— é›†æˆ Merlin Chain MCP å®¢æˆ·ç«¯ï¼Œæ”¯æŒçœŸå®å·¥å…·è°ƒç”¨
- ğŸ“Š æ”¯æŒæ‰¹é‡ç”Ÿæˆï¼Œé¿å…APIé™æµ
- ğŸ’¾ è‡ªåŠ¨ä¿å­˜ä¸­é—´ç»“æœï¼Œé˜²æ­¢æ•°æ®ä¸¢å¤±
- ğŸ¯ é’ˆå¯¹ Merlin Chain (BTC Layer2) çš„20ä¸ªMCPå·¥å…·ä¼˜åŒ–
- ğŸ“ ä¸¤é˜¶æ®µç”Ÿæˆï¼šé—®é¢˜ç”Ÿæˆ + å®Œæ•´å¯¹è¯ç”Ÿæˆ
- âš¡ æ¨¡å—åŒ–è®¾è®¡ï¼Œç»„ä»¶å¯å¤ç”¨

## é¡¹ç›®ç»“æ„

```
ai_dataset/
â”œâ”€â”€ prompt.txt                      # é—®é¢˜ç”Ÿæˆä»»åŠ¡çš„æç¤ºè¯
â”œâ”€â”€ prompt-2.txt                    # å®Œæ•´å¯¹è¯ç”Ÿæˆä»»åŠ¡çš„æç¤ºè¯
â”œâ”€â”€ generate_question_dataset.py    # ç”Ÿæˆé—®é¢˜æ•°æ®é›†ï¼ˆé˜¶æ®µ1ï¼‰
â”œâ”€â”€ generate_complete_dataset.py    # ç”Ÿæˆå®Œæ•´å¯¹è¯æ•°æ®é›†ï¼ˆé˜¶æ®µ2ï¼‰
â”œâ”€â”€ merlin_mcp_client.py            # Merlin Chain MCPå®¢æˆ·ç«¯å°è£…
â”œâ”€â”€ deepseek_api_client.py          # DeepSeek APIå®¢æˆ·ç«¯å°è£…
â”œâ”€â”€ dataset_utils.py                # æ•°æ®é›†å¤„ç†å·¥å…·ç±»
â””â”€â”€ requirements.txt                # Pythonä¾èµ–åˆ—è¡¨
```

## å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
pip install -r requirements.txt
```

### 2. è·å– Deepseek API Key

è®¿é—® [Deepseekå®˜ç½‘](https://platform.deepseek.com/) è·å–API Key

### 3. ä¸¤é˜¶æ®µæ•°æ®ç”Ÿæˆ

#### é˜¶æ®µ1ï¼šç”Ÿæˆé—®é¢˜æ•°æ®é›†

```bash
# ä½¿ç”¨é»˜è®¤å‚æ•° (6000ä¸ªå¯¹è¯ï¼Œæ‰¹æ¬¡å¤§å°50)
python generate_question_dataset.py

# è‡ªå®šä¹‰å‚æ•°
python generate_question_dataset.py --total_conversations 1000 --batch_size 25 --output_file my_questions.json

# å®Œæ•´å‚æ•°ç¤ºä¾‹
python generate_question_dataset.py \
    --total_conversations 2000 \
    --batch_size 30 \
    --output_file custom_dataset.json \
    --prompt_file prompt.txt \
    --api_key YOUR_API_KEY
```

ç”Ÿæˆç”¨æˆ·é—®é¢˜å’Œassistantå¼•å¯¼å¯¹è¯ï¼Œé»˜è®¤è¾“å‡ºåˆ° `function_calling_dataset.json`

#### é˜¶æ®µ2ï¼šç”Ÿæˆå®Œæ•´å¯¹è¯æ•°æ®é›†

```bash
# ä½¿ç”¨é»˜è®¤å‚æ•°
python generate_complete_dataset.py

# è‡ªå®šä¹‰å‚æ•°
python generate_complete_dataset.py --input_file my_questions.json --output_file my_complete.json --batch_size 2

# æ–­ç‚¹ç»­ä¼  (ä»ç¬¬100ä¸ªå¯¹è¯å¼€å§‹)
python generate_complete_dataset.py --start_from 100

# å®Œæ•´å‚æ•°ç¤ºä¾‹
python generate_complete_dataset.py \
    --input_file custom_dataset.json \
    --output_file custom_complete.json \
    --batch_size 1 \
    --start_from 0 \
    --api_key YOUR_API_KEY
```

åŸºäºé—®é¢˜æ•°æ®é›†ï¼Œè°ƒç”¨MCPå·¥å…·ç”Ÿæˆå®Œæ•´å¯¹è¯ï¼Œé»˜è®¤è¾“å‡ºåˆ° `function_calling_dataset-2.json`

## æ ¸å¿ƒç»„ä»¶

### MCPå®¢æˆ·ç«¯ (`merlin_mcp_client.py`)
- å°è£…ä¸Merlin Chain MCPæœåŠ¡å™¨çš„è¿æ¥
- æ”¯æŒSSEåè®®å’Œå·¥å…·è°ƒç”¨
- è‡ªåŠ¨è·å–å·¥å…·schema

### APIå®¢æˆ·ç«¯ (`deepseek_api_client.py`) 
- å°è£…DeepSeek APIè°ƒç”¨
- æ”¯æŒfunction calling
- åŒ…å«é‡è¯•æœºåˆ¶å’Œé”™è¯¯å¤„ç†

### å·¥å…·ç±» (`dataset_utils.py`)
- JSONæ•°æ®è§£æå’Œæ ¼å¼è½¬æ¢
- æ–‡ä»¶è¯»å†™æ“ä½œ
- ShareGPTæ ¼å¼æ”¯æŒ

## å‘½ä»¤è¡Œå‚æ•°

### é—®é¢˜æ•°æ®é›†ç”Ÿæˆè„šæœ¬å‚æ•°

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|---------|------|
| `--total_conversations` | int | 6000 | ç›®æ ‡å¯¹è¯æ•°é‡ |
| `--batch_size` | int | 50 | æ¯æ‰¹ç”Ÿæˆçš„å¯¹è¯æ•°é‡ |
| `--output_file` | str | function_calling_dataset.json | è¾“å‡ºæ–‡ä»¶å |
| `--prompt_file` | str | prompt.txt | æç¤ºè¯æ–‡ä»¶è·¯å¾„ |
| `--api_key` | str | - | DeepSeek API Key (å¯é€‰) |

### å®Œæ•´æ•°æ®é›†ç”Ÿæˆè„šæœ¬å‚æ•°

| å‚æ•° | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|---------|------|
| `--input_file` | str | function_calling_dataset.json | è¾“å…¥é—®é¢˜æ•°æ®é›†æ–‡ä»¶ |
| `--output_file` | str | function_calling_dataset-2.json | è¾“å‡ºå®Œæ•´æ•°æ®é›†æ–‡ä»¶ |
| `--batch_size` | int | 1 | æ¯æ‰¹å¤„ç†çš„å¯¹è¯æ•°é‡ |
| `--start_from` | int | 0 | ä»ç¬¬å‡ ä¸ªå¯¹è¯å¼€å§‹å¤„ç† |
| `--api_key` | str | - | DeepSeek API Key (å¯é€‰) |

### æŸ¥çœ‹å¸®åŠ©ä¿¡æ¯

```bash
# æŸ¥çœ‹é—®é¢˜ç”Ÿæˆè„šæœ¬å¸®åŠ©
python generate_question_dataset.py --help

# æŸ¥çœ‹å®Œæ•´æ•°æ®é›†ç”Ÿæˆè„šæœ¬å¸®åŠ©
python generate_complete_dataset.py --help
```

## è¾“å‡ºæ ¼å¼

```json
{
  "metadata": {
    "total_conversations": 1000,
    "generated_at": "2024-01-01 12:00:00",
    "target_conversations": 6000,
    "batch_size": 50
  },
  "conversations": [
    {
      "conversations": [
        {
          "from": "user",
          "value": "æˆ‘æƒ³æŸ¥çœ‹è¿™ä¸ªäº¤æ˜“çš„è¯¦æƒ…"
        },
        {
          "from": "assistant", 
          "value": "è¯·æä¾›äº¤æ˜“å“ˆå¸Œ..."
        }
      ]
    }
  ]
}
```

## ä½¿ç”¨ç¤ºä¾‹

### å¿«é€Ÿå¼€å§‹ (ä½¿ç”¨é»˜è®¤å‚æ•°)
```bash
# ç¬¬ä¸€æ­¥ï¼šç”Ÿæˆ1000ä¸ªé—®é¢˜å¯¹è¯ (å°è§„æ¨¡æµ‹è¯•)
python3 generate_question_dataset.py --total_conversations 1000 --batch_size 20

# ç¬¬äºŒæ­¥ï¼šç”Ÿæˆå®Œæ•´æ•°æ®é›†
python3 generate_complete_dataset.py --batch_size 1
```

### ç”Ÿäº§ç¯å¢ƒä½¿ç”¨
```bash
# ç”Ÿæˆ6000ä¸ªé—®é¢˜å¯¹è¯ (é»˜è®¤ç›®æ ‡)
python3 generate_question_dataset.py

# ç”Ÿæˆå®Œæ•´æ•°æ®é›†ï¼Œæ‰¹æ¬¡å¤§å°ä¸º2ï¼Œæé«˜æ•ˆç‡
python3 generate_complete_dataset.py --batch_size 2
```

### æ–­ç‚¹ç»­ä¼ 
```bash
# å¦‚æœå¤„ç†ä¸­æ–­ï¼Œä»ç¬¬500ä¸ªå¯¹è¯ç»§ç»­
python3 generate_complete_dataset.py --start_from 500
```

### è‡ªå®šä¹‰æ–‡ä»¶å
```bash
# ä½¿ç”¨è‡ªå®šä¹‰æ–‡ä»¶å
python3 generate_question_dataset.py --output_file my_questions.json
python3 generate_complete_dataset.py --input_file my_questions.json --output_file my_complete.json
```

## æ³¨æ„äº‹é¡¹

1. **APIé™æµ**: è„šæœ¬ä¼šåœ¨æ‰¹æ¬¡é—´è‡ªåŠ¨å»¶è¿Ÿï¼Œé¿å…è§¦å‘é™æµ
2. **ä¸­é—´ç»“æœ**: æ¯æ‰¹ç”Ÿæˆçš„æ•°æ®éƒ½ä¼šä¿å­˜ä¸ºä¸´æ—¶æ–‡ä»¶
3. **é”™è¯¯å¤„ç†**: å•æ‰¹å¤±è´¥ä¸ä¼šå½±å“æ•´ä½“è¿›ç¨‹
4. **æ•°æ®è´¨é‡**: å»ºè®®ç”Ÿæˆåäººå·¥å®¡æ ¸éƒ¨åˆ†æ•°æ®
5. **æ‰¹æ¬¡å¤§å°**: é—®é¢˜ç”Ÿæˆå»ºè®®50ä¸ª/æ‰¹ï¼Œå®Œæ•´å¯¹è¯ç”Ÿæˆå»ºè®®1-2ä¸ª/æ‰¹
6. **è¿›åº¦è·Ÿè¸ª**: æ”¯æŒæ–­ç‚¹ç»­ä¼ ï¼Œå¯éšæ—¶ä¸­æ–­å’Œæ¢å¤

## æ•…éšœæ’é™¤

### APIè°ƒç”¨å¤±è´¥
- æ£€æŸ¥API Keyæ˜¯å¦æ­£ç¡®
- ç¡®è®¤ç½‘ç»œè¿æ¥æ­£å¸¸
- éªŒè¯DeepseekæœåŠ¡çŠ¶æ€

### JSONè§£æé”™è¯¯
- æ£€æŸ¥prompt.txtæ ¼å¼æ˜¯å¦æ­£ç¡®
- ç¡®è®¤APIè¿”å›å†…å®¹æ ¼å¼

### ç”Ÿæˆæ•°æ®ä¸ç¬¦åˆé¢„æœŸ
- è°ƒæ•´prompt.txtä¸­çš„æŒ‡ä»¤
- ä¿®æ”¹temperatureå‚æ•°æ§åˆ¶éšæœºæ€§

## è´¡çŒ®

æ¬¢è¿æäº¤Issueå’ŒPull Requestæ¥æ”¹è¿›æ­¤é¡¹ç›®ã€‚

## è®¸å¯è¯

MIT License